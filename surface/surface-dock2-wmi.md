---
title: Gerenciar o Surface Dock 2 com WMI
description: Este artigo explica como usar o WMI para monitorar e gerenciar remotamente o firmware mais recente, o estado da política e os dados relacionados entre dispositivos do Surface Dock 2.
ms.prod: w10
ms.mktglfcycl: manage
ms.localizationpriority: medium
ms.sitesec: library
author: coveminer
ms.author: greglin
ms.topic: article
ms.date: 8/05/2020
ms.reviewer: hachidan
manager: laurawi
audience: itpro
ms.openlocfilehash: 2c7e4ac00eea798613335a320b21ce6fcb9f9f2d
ms.sourcegitcommit: 97e19fdcd074647bedec9efdfd3ce28e900ae2ea
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/05/2020
ms.locfileid: "10916503"
---
# Gerenciar o Surface Dock 2 com WMI

O suporte à instrumentação de gerenciamento do Windows (WMI) fornece um rico conjunto de informações de diagnóstico, permitindo que os administradores de ti monitorem e gerenciem remotamente o firmware mais recente, o estado da política e os dados relacionados entre dispositivos do Surface Dock 2. Você pode usar o WMI com o Windows PowerShell, System Center Operations Manager e outras ferramentas. Para obter mais informações sobre o WMI, consulte [trabalhando com WMI](https://docs.microsoft.com/powershell/scripting/learn/ps101/07-working-with-wmi?view=powershell-5.1). 

Para habilitar o suporte ao WMI, vá para [drivers e firmware do Surface Dock 2](https://www.microsoft.com/download/details.aspx?id=101317) e baixe o pacote apropriado:

**SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;versão # C1_x64.msi:**<br>

- Surface pro (5ª Gen e posterior)
- Livro Surface (2ª Gen e posterior)
- Superfície Go (todas as gerações)
- Laptop Surface (todas as gerações)

 **SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;versão # C1_arm64.msi:** <br>

- Surface Pro X

## Usando WMI com o Surface Dock 2

1. Para enumerar todas as ocorrências do componente Dock:

    ```PowerShell
    Get-CimInstance -Namespace "root/Surface" -Class "SurfaceDockComponent" 
    ```
2. Para acessar descrições de propriedades de classe WMI, abra um prompt de comando e insira os comandos WMI em que **Propriedade** é uma das propriedades listadas na tabela 1.

    ```PowerShell
     Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["<Property>"]
    ```

- **Exemplo:** Para acessar a descrição da propriedade Common Information Model (CIM) da **versão** , insira o seguinte:
    ```PowerShell
    (Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["Version"].Qualifiers["Description"].Value
    ```
 
 ### Tabela 1. Referência WMI do Surface Dock 2

| Propriedade         | Tipo   | Valor (es) esperado (s)                                                                                                                                                                                                            | Descrição                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ---------------- | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ComponentName    | String | Microcontrolador <br>"Hub USB 1" <br>"Hub USB 2" <br>"Exibir hub de portabilidade" <br>"Controlador de entrega de energia" <br>"Codec de áudio" <br>"Controlador Ethernet"                                                                         | A propriedade a seguir lista o nome específico do componente de dispositivo que os dados de classe de modelo CIM (Common Information Model) que acompanham o (modelo de informação comum) correspondem a.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| DeviceName       | String | "Surface Dock 1" <br>"Surface Dock 2"                                                                                                                                                                                        | A propriedade a seguir contém o nome do dispositivo Dock ao qual o componente de dispositivo específico pertence.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| DockSerialNumber | String | Um número de série de doze (12) dígitos que contém apenas valores numéricos                                                                                                                                                           | A propriedade a seguir registra o número de série do dispositivo Dock conectado. Esse número de série é exatamente o mesmo para todos os componentes, pois eles pertencem ao mesmo dispositivo Dock. Para referência, esse número de série pode ser encontrado fisicamente na parte inferior do Surface Dock.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Id               | UInt16 | 0, 1, 2,..., 65535                                                                                                                                                                                                          | A propriedade a seguir é uma ID exclusiva que começa do zero (0) e conta. Essa variável é usada para numerar as instâncias enumeradas WMI.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| LastUpdateStatus | String | Cessões <br>"PendingDockReattach" <br>Conseguiu                                                                                                                                                                             | A propriedade a seguir detalha o status da atualização do firmware do componente (CFU) mais recente tentada para o componente do dispositivo em questão. Os valores possíveis são: **êxito,** **reconexão de encaixe pendente** e **falha.**<br><br><br>- **Êxito** indica que o novo firmware aplicado anteriormente foi aplicado com êxito<br>- A **reconexão do Dock pendente** indica que há uma nova atualização pendente para o componente do dispositivo e o usuário deve desanexar e anexar novamente o conector da superfície do encaixe para aplicar a nova atualização.<br>- **Falha** indica que um possível erro legítimo ocorrido durante o processo de CFU ou o periférico não foi inicializado na versão esperada. No caso de **falha** , não é uma indicação de que o dispositivo não está funcionando, mas algo errado ocorreu ao tentar atualizar o dispositivo. Nesse caso, o firmware anterior continuará a ser executado.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Políticastate      | String | Possibilita <br>Ativo                                                                                                                                                                                                     | A propriedade a seguir indica a política do modo de gerenciamento corporativo de Surface (SEMM) atual para o componente de dispositivo. Os valores possíveis são: **Enabled** e **Disabled.**<br><br><br>- **Enabled** indica que o sistema Semm permitiu que o dispositivo host acesse e use o componente de dispositivo<br>- **Disabled** indica que o sistema Semm não permite e, portanto, impedia o acesso do computador host e o uso do componente do dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProductId        | String [] | Uma lista de cadeias de caracteres hexadecimais, que podem cada faixa de "0x0000" a "0xFFFF"                                                                                                                                                        | A propriedade a seguir classifica a ID do produto (PID) do componente do dispositivo. É possível que haja mais de um PID listado. No caso de um hub USB, por exemplo, os dispositivos super velocidade (SS) e de alta velocidade (HS) são incluídos em um hub singular ". Portanto, duas (2) PIDs serão listadas nesta matriz.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProvisionedState         | boolean | Verdadeiro ou falso                                                                                                                                                        | A propriedade a seguir descreve o estado provisionado do modo de gerenciamento da empresa Surface (SEMM) do dispositivo do Surface Dock. O estado provisionado é o mesmo exato para cada componente, pois eles pertencem ao mesmo dispositivo Dock. Os valores possíveis são: true ou false. Um valor true indica que o dispositivo Dock Dock é atualmente gerenciado e, portanto, a funcionalidade de porta pode ser restrita. Consulte o campo de propriedade "Policystate" para obter mais informações. Um valor false indica que o dispositivo do Dock Surface não está atualmente gerenciado e não tem restrições de recurso impostas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Status           | String | Ok <br>Desconectado <br>Erros <br>Esteja <br>"DeviceHandleInUse" <br>Ativo <br>"NotSupportedByWmi"                                                                                                             | A propriedade a seguir descreve o estado da conexão do Dock com o computador host. Os valores possíveis são: **OK,** **desconectado,** **erro,** **ausente,** **DeviceHandleInUse,**  **desabilitado** e **NotSupportedByWmi.** <br>- **OK** indica que o dispositivo está conectado com êxito ao computador host e que não existe problema, o que inibi a funcionalidade <br>- **Desconectado** indica que o conector Surface, que fornece a conexão para todos os componentes do dispositivo, não está atualmente anexado ao computador host. <br>- O **erro** indica um possível problema com a instância do dispositivo e a interface do dispositivo tem mais do que provavelmente foi rotulada com um ponto de exclamação amarelo no Gerenciador de dispositivos – Verifique a propriedade **StatusCode** para obter informações mais detalhadas sobre o tipo de erro que ocorreu. <br>- **Missing** indica que espera-se que o dispositivo tivesse sido enumerado na máquina host, mas por algum motivo não. A propriedade **StatusCode** irá conter o valor de 24 para indicar essa situação errada.<br>- **DeviceHandleInUse** indica que outro processo está se comunicando no momento com o dispositivo, que proíbe este provedor de instância de instrumentação de gerenciamento do Windows (WMI) de suas solicitações de comunicação. Tente executar o comando WMI novamente! <br> - **Disabled** indica que a política do modo de gerenciamento corporativo de Surface (Semm) atual não foi permitida e, portanto, impedia o acesso ao computador host e use o componente do dispositivo. Consulte o campo da propriedade **policystate** para obter mais informações.<br>- **NotSupportedByWmi** indica que o encaixe conectado atualmente não é compatível com este provedor WMI. Esse status será exibido para o Surface Dock 1, que atualmente não é compatível com este provedor de instância WMI.|
| StatusCode       | UInt32 | [Código de erro do Gerenciador de dispositivos](https://docs.microsoft.com/windows-hardware/drivers/install/device-manager-error-messages) obtido da classe WMI CIM_LogicalDevice (dentro de *Cimwin32. mof*) | A propriedade a seguir fornece o código de erro do Gerenciador de dispositivos para o componente Dock fornecido. Um valor zero (0) indica que o componente Dock está funcionando corretamente; um valor maior que zero (0) indica um problema ou um possível erro com o componente Dock. Como o componente Dock pode enumerar com várias interfaces de dispositivo, é possível que haja códigos de erro adicionais do Device Manager. Este campo de propriedade só lista um único código de erro, mesmo se vários estiverem disponíveis. O Gerenciador de dispositivos rotulará o dispositivo com um ponto de exclamação amarelo apenas quando ocorrerem determinados códigos de erro.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| VendorID         | String | Uma cadeia de caracteres Hex que pode variar de "0x0000" para "0xFFFF"                                                                                                                                                                        | A propriedade a seguir observa a ID de fornecedor específica (VID) do componente de dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Versão          | String | Uma cadeia de caracteres de versão, que tem o formulário da seguinte maneira: "x. y. z", em que x, y e z são valores numéricos.                                                                                                                            | A propriedade a seguir especifica a versão atual do firmware, que, no momento, está em execução no componente do dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |


## Saiba mais

- [Portas do Secure Surface Dock 2 com SEMM](secure-surface-dock-ports-semm.md)
- [Novidades no Surface Dock 2](surface-dock-whats-new.md)
- [Códigos de erro do Gerenciador de dispositivos](https://docs.microsoft.com/windows-hardware/drivers/install/device-manager-error-messages)
- [Trabalhando com WMI](https://docs.microsoft.com/powershell/scripting/learn/ps101/07-working-with-wmi?view=powershell-5.1)
